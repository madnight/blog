<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=10.0">
    <meta name="author" content="Fabian Beuke">
    <link href="/fav.png" as="image" onload="this.rel='shortcut icon'" sizes="45x48">
    <noscript>
        <link rel="shortcut icon" sizes="45x48" href="/fav.png">
    </noscript>
    <link rel="icon" href="/fav.png" onload="if(media!='all')media='all'">
    <noscript>
        <link rel="icon" href="/fav.png">
    </noscript>
    <title>beuke.org</title>
    <meta name="description" content="A personal blog about computer science and theoretical physics.">
    <link rel="alternate" type="application/rss+xml" title="beuke.org" href="/atom.xml" onload="if(media!='all')media='all'">
    <noscript>
        <link rel="alternate" type="application/rss+xml" title="beuke.org" href="/atom.xml">
    </noscript>
    <link rel="preload" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" as="style">
    <link rel="stylesheet" href="/css/simple.css/simple.min.css" as="style">
    <link rel="stylesheet" href="/css/main.css" onload="if(media!='all')media='all'">
    <noscript>
        <link rel="stylesheet" href="/css/main.css">
    </noscript>
    <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css" media="none" onload="if(media!='all')media='all'">
    <noscript>
        <link rel="stylesheet" href="//cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.9/katex.min.css">
    </noscript>
    <link rel="stylesheet" href="/css/light.css" media="(prefers-color-scheme: light)">
    <link rel="stylesheet" href="/css/dark.css" media="(prefers-color-scheme: dark)">
    <!--<script src="https://googlechromelabs.github.io/dark-mode-toggle/src/dark-mode-toggle-stylesheets-loader.js"></script>-->
    <script type="module" src="https://unpkg.com/dark-mode-toggle"></script>
    <script defer type="text/javascript">
        document.addEventListener("DOMContentLoaded", function (event)
        {
            //- fix for single quotes in pre blocks
            document.body.innerHTML = document.body.innerHTML.replaceAll('', '\'');
        });

    </script>
    <script defer src="/js/table-wrapper.js"></script>
    <meta name="generator" content="Hexo 6.3.0">
</head>
<header>
    <nav>
        <a href="/"> Home</a>
        <a target="_blank" rel="noopener" href="https://github.com/madnight"> Github</a>
        <a href="/atom.xml"> RSS</a>
        <a href="/about/"> About</a>
    </nav>
    <div class="title-con">
        <div class="title-container">
            <h1>beuke.org</h1>
            <dark-mode-toggle id="dark-mode-toggle-1" appearance="toggle"></dark-mode-toggle>
        </div>
    </div>
    <h2>A personal blog exploring computer science and theoretical physics</h2>
</header>

<body>
    <main>
        <article>
            <section>
                <div class="post-title"> JSON Parsing in ELM </div>
                <div class="post-subtitle"> JSON parsing in a purely functional web language </div>
                <div class="post-subsubtitle"> Posted on Jan 14 2017 ~ 6 min read</div>
                <div class="post-subtitle-tags">
                    <a href="/tags/elm/">#elm</a>Â  <a href="/tags/json/">#json</a>Â  <a href="/tags/functional-programming/">#functional programming</a>Â  </div>
                <hr class="solid">
            </section>
            <div class"content">
                <link rel="stylesheet" type="text/css" href="https://cdn.jsdelivr.net/hint.css/2.4.1/hint.min.css">
                <h1 id="immutable-state-of-the-art"><a class="markdownIt-Anchor" href="#immutable-state-of-the-art"></a> Immutable State of the Art</h1>
                <p>There is a ongoing hype of JavaScript<sup id="fnref:1"><a href="#fn:1" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Programming Languages GitHub Ranking](https://madnight.github.io/githut)
">[1]</span></a></sup> in the developer community. Virtually everything is now compiled to JavaScript and delivered to the client. JavaScript is also becoming very popular for server side development<sup id="fnref:2"><a href="#fn:2" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Event-driven I/O server-side JavaScript environment based on V8](https://en.wikipedia.org/wiki/Node.js)
">[2]</span></a></sup>, replacing Ruby and PHP as primary programming language.<sup id="fnref:9"><a href="#fn:9" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[JavaScript more widely used in industry than PHP or Ruby](http://www.tiobe.com/tiobe-index/)
">[9]</span></a></sup> Not only that, thereâ€™s also an ongoing serverless trend, moving most of the back-end code into the front-end part of the application.<sup id="fnref:3"><a href="#fn:3" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[What is Serverless Architecture?](https://medium.com/@PaulDJohnston/what-is-serverless-architecture-43b9ea4babca#.5adec3yz0)
">[3]</span></a></sup> This paradigm shift results in highly complex front-end applications, making it very complicated to write applications with plain old vanilla JavaScript. For this reason, the community started to put much effort in improving the JavaScript front-end development. A new JavaScript Standard ES6 (ECMAScript 2015) has been published. The Babel compiler, compiles that new standard to vanilla JavaScript, allowing itâ€™s execution in older browsers. Frameworks and tools like react, webpack, karma, mocha, enzyme, gulp, eslint and many more to make the life as JavaScript developer as comfortable as possible.<sup id="fnref:5"><a href="#fn:5" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Boilerplate Example react-webpack-babel-karma-boilerplate](https://github.com/madnight/react-webpack-babel-karma-boilerplate)
">[5]</span></a></sup></p>
                <p>It takes many weeks to get familiar with the new toolchain, but it pays off in the long run. Following all current best practices leads to a setup with many different tools and a highly improved JavaScript syntax, that basically follows the approach of reactive functional programming. Why is that? Well, the major problem is mutable state.<sup id="fnref:8"><a href="#fn:8" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[How can you do anything useful without mutable state?]( http://stackoverflow.com/questions/1020653/how-can-you-do-anything-useful-without-mutable-state)
">[8]</span></a></sup> Mutable state is not only a potential source of bugs, it is also one of the top reasons for unpredictable application behaviour and is in principle not compatible with parallelization.<sup id="fnref:6"><a href="#fn:6" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[So You Want to be a Functional Programmer]( https://medium.com/@cscalfani/so-you-want-to-be-a-functional-programmer-part-1-1f15e387e536#.wu667z5wl)
">[6]</span></a></sup> So, why not experimenting with a new reactive functional programming language explicitly designed for front-end programming, that compiles to vanilla JavaScript.</p>
                <h1 id="parse-json-in-elm-018"><a class="markdownIt-Anchor" href="#parse-json-in-elm-018"></a> Parse JSON in Elm 0.18</h1>
                <p>Elm is a static typed, reactive, pure functional programming language. It has a simplified Haskell syntax, making it much easier to use than Haskell. It is focused on front-end web development and therefore compiles to JavaScript. It has the builtin features of react and redux.<sup id="fnref:7"><a href="#fn:7" rel="footnote"><span class="hint--top hint--error hint--medium hint--rounded hint--bounce" aria-label="[Redux is influenced by ELM](https://github.com/reactjs/redux#Influences)
">[7]</span></a></sup></p>
                <p>Lets consider an JSON API in the following format:</p>
                <figure class="highlight">
                    <pre><font face="monospace"><font color="#afaf5f">[</font>
Â Â <font color="#afaf5f">{</font>
Â Â Â Â "<font color="#87afd7">name</font>":Â "<font color="#afaf5f">JavaScript</font>",
Â Â Â Â "<font color="#87afd7">year</font>":Â "<font color="#afaf5f">2012</font>",
Â Â Â Â "<font color="#87afd7">quarter</font>":Â "<font color="#afaf5f">2</font>",
Â Â Â Â "<font color="#87afd7">count</font>":Â "<font color="#afaf5f">118009</font>"
Â Â <font color="#afaf5f">}</font>,
Â Â <font color="#afaf5f">{</font>
Â Â Â Â "<font color="#87afd7">name</font>":Â "<font color="#afaf5f">Ruby</font>",
Â Â Â Â "<font color="#87afd7">year</font>":Â "<font color="#afaf5f">2012</font>",
Â Â Â Â "<font color="#87afd7">quarter</font>":Â "<font color="#afaf5f">2</font>",
Â Â Â Â "<font color="#87afd7">count</font>":Â "<font color="#afaf5f">67773</font>"
Â Â <font color="#afaf5f">}</font>,
Â Â <font color="#afaf5f">{</font>
Â Â Â Â "<font color="#87afd7">name</font>":Â "<font color="#afaf5f">Python</font>",
Â Â Â Â "<font color="#87afd7">year</font>":Â "<font color="#afaf5f">2012</font>",
Â Â Â Â "<font color="#87afd7">quarter</font>":Â "<font color="#afaf5f">2</font>",
Â Â Â Â "<font color="#87afd7">count</font>":Â "<font color="#afaf5f">42212</font>"
Â Â <font color="#afaf5f">}</font>
<font color="#afaf5f">]</font>
</font></pre>
                </figure>
                <p>Since Elm is strongly typed we have to create a type that matches the given JSON objects.</p>
                <figure class="highlight">
                    <pre><font face="monospace"><font color="#d7875f">type</font>Â <font color="#afaf5f">alias</font>Â <font color="#d7875f">ProgrammingLanguage</font>Â =Â <font color="#afaf5f">{</font>
<font color="#ffd75f">Â Â name :Â </font><font color="#d7875f">String</font><font color="#afaf5f">,</font>
<font color="#ffd75f">Â Â year :Â </font><font color="#d7875f">Int</font><font color="#afaf5f">,</font>
<font color="#ffd75f">Â Â quarter :Â </font><font color="#d7875f">Int</font><font color="#afaf5f">,</font>
<font color="#ffd75f">Â Â count :Â </font><font color="#d7875f">Int</font>
<font color="#afaf5f">}</font>
</font></pre>
                </figure>
                <p>As you can see the attribute name is a string and year, quarter, count are integers. The JSON API provides integers encoded as strings, so it is necessary to do a type cast. Therefore we need to write a simple custom decoder, that converts a string to integer.</p>
                <figure class="highlight">
                    <pre><font face="monospace"><font color="#ffd75f">stringAsInt</font>Â :Â <font color="#d7875f">Decoder</font>Â <font color="#d7875f">Int</font>
<font color="#ffd75f">stringAsInt</font>Â = stringÂ <font color="#87afaf">|></font>Â andThenÂ <font color="#afaf5f">(</font><font color="#d7875f">String</font>.toIntÂ <font color="#87afaf">>></font>Â fromResult<font color="#afaf5f">)</font>
</font></pre>
                </figure>
                <p>Lets take a look at the type definition to see how this works.<br>
                    <code>andThen : (a -> Decoder b) -> Decoder a -> Decoder b</code><br> The function <code>andThen</code> takes two arguments a decoder a, in this case the standard string decoder and a type cast function from a to decoder b that converts the result of our string decoder to an new decoder of type b. This procedure is a simple chain, first decode as string and then decode as int by type conversion. If you know Haskell <code>andThen</code> is the equivalent of <code>(=<<) :: Monad m=> (a -> m b) -> m a -> m b</code> the monadic bind that sequentially compose two actions by passing any value produced by the first as an argument to the second. If you are not familiar with the pipe <code>|></code> and function composition <code>>></code> notation you can also write the function with as a lambda expression <code>andThen (\n -> fromResult(String.toInt(n))) string</code>. Now we are able to use that decoder to decode a single JSON object.</p>
                <figure class="highlight">
                    <pre><font face="monospace"><font color="#ffd75f">langDecoder</font>Â :Â <font color="#d7875f">Decoder</font>Â <font color="#d7875f">ProgrammingLanguage</font>
<font color="#ffd75f">langDecoder</font>Â =
Â Â map4Â <font color="#d7875f">ProgrammingLanguage</font>
Â Â Â Â <font color="#afaf5f">(</font>fieldÂ <font color="#afaf5f">"name"</font>Â string<font color="#afaf5f">)</font>
Â Â Â Â <font color="#afaf5f">(</font>fieldÂ <font color="#afaf5f">"year"</font>Â stringAsInt<font color="#afaf5f">)</font>
Â Â Â Â <font color="#afaf5f">(</font>fieldÂ <font color="#afaf5f">"quarter"</font>Â stringAsInt<font color="#afaf5f">)</font>
Â Â Â Â <font color="#afaf5f">(</font>fieldÂ <font color="#afaf5f">"count"</font>Â stringAsInt<font color="#afaf5f">)</font>
</font></pre>
                </figure>
                <p>Since our API is a list of programming language objects we need to parse the whole list. <code>Json.Decode.list : Decoder a -> Decoder (List a)</code></p>
                <figure class="highlight">
                    <pre><font face="monospace"><font color="#ffd75f">langListDecoder</font>Â :Â <font color="#d7875f">Decoder</font>Â <font color="#afaf5f">(</font><font color="#d7875f">List</font>Â <font color="#d7875f">ProgrammingLanguage</font><font color="#afaf5f">)</font>
<font color="#ffd75f">langListDecoder</font>Â =Â <font color="#d7875f">Json.Decode</font>.list langDecoder
</font></pre>
                </figure>
                <p>Finally you are able to use the decoder to parse JSON from a given URL <code>Http.get url langListDecoder</code></p>
                <figure class="highlight">
                    <pre><font face="monospace"><font color="#ffd75f">getProgrammingLanguages</font>Â :Â <font color="#d7875f">Cmd</font>Â <font color="#d7875f">Msg</font>
<font color="#ffd75f">getProgrammingLanguages</font>Â =
Â Â <font color="#d7875f">let</font>Â url =Â <font color="#afaf5f">"gh-star-event.json"</font>
Â Â <font color="#d7875f">in</font>Â <font color="#d7875f">Http</font>.sendÂ <font color="#d7875f">NewLang</font>Â <font color="#afaf5f">(</font><font color="#d7875f">Http</font>.get url langListDecoder<font color="#afaf5f">)</font>
</font></pre>
                </figure>
                <p>See <a target="_blank" rel="noopener" href="https://github.com/madnight/elm-webpack-starter">https://github.com/madnight/elm-webpack-starter</a> for a full working API parsing example.</p>
                <h2 id="update"><a class="markdownIt-Anchor" href="#update"></a> Update</h2>
                <p>Thereâ€™s a new command line tool and website <a target="_blank" rel="noopener" href="https://github.com/eeue56/json-to-elm">https://github.com/eeue56/json-to-elm</a> that allows for automatic conversion of JSON to elm code.</p>
                <blockquote>
                    <p>This project allows you to automate the creation of:</p>
                    <ul>
                        <li>type aliases from JSON data</li>
                        <li>decoders from type aliases and some union types</li>
                        <li>encoders from type aliases and some union types</li>
                    </ul>
                </blockquote>
                <h2 id="references"><a class="markdownIt-Anchor" href="#references"></a> References</h2>
                <div id="footnotes">
                    <hr>
                    <div id="footnotelist">
                        <ol style="list-style: none; padding-left: 0; margin-left: 40px">
                            <li id="fn:1"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">1.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://madnight.github.io/githut">Programming Languages GitHub Ranking</a><a href="#fnref:1" rev="footnote"> â†©</a></span></li>
                            <li id="fn:2"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">2.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://en.wikipedia.org/wiki/Node.js">Event-driven I/O server-side JavaScript environment based on V8</a><a href="#fnref:2" rev="footnote"> â†©</a></span></li>
                            <li id="fn:3"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">3.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://medium.com/@PaulDJohnston/what-is-serverless-architecture-43b9ea4babca#.5adec3yz0">What is Serverless Architecture?</a><a href="#fnref:3" rev="footnote"> â†©</a></span></li>
                            <li id="fn:4"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">4.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://www.youtube.com/watch?v=PB_d3uBkQPs">Destructuring: What, Why and How - Part 1 of ES6 JavaScript Features</a><a href="#fnref:4" rev="footnote"> â†©</a></span></li>
                            <li id="fn:5"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">5.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://github.com/madnight/react-webpack-babel-karma-boilerplate">Boilerplate Example react-webpack-babel-karma-boilerplate</a><a href="#fnref:5" rev="footnote"> â†©</a></span></li>
                            <li id="fn:6"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">6.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://medium.com/@cscalfani/so-you-want-to-be-a-functional-programmer-part-1-1f15e387e536#.wu667z5wl">So You Want to be a Functional Programmer</a><a href="#fnref:6" rev="footnote"> â†©</a></span></li>
                            <li id="fn:7"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">7.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="https://github.com/reactjs/redux#Influences">Redux is influenced by ELM</a><a href="#fnref:7" rev="footnote"> â†©</a></span></li>
                            <li id="fn:8"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">8.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="http://stackoverflow.com/questions/1020653/how-can-you-do-anything-useful-without-mutable-state">How can you do anything useful without mutable state?</a><a href="#fnref:8" rev="footnote"> â†©</a></span></li>
                            <li id="fn:9"><span style="display: inline-block; vertical-align: top; padding-right: 10px; margin-left: -40px">9.</span><span style="display: inline-block; vertical-align: top; margin-left: 10px;"><a target="_blank" rel="noopener" href="http://www.tiobe.com/tiobe-index/">JavaScript more widely used in industry than PHP or Ruby</a><a href="#fnref:9" rev="footnote"> â†©</a></span></li>
                        </ol>
                    </div>
                </div>
            </div>
        </article>
    </main>
    <footer>
        <p>This blog was made with <a target="_blank" rel="noopener" href="https://hexo.io/">Hexo</a> and <a target="_blank" rel="noopener" href="https://simplecss.org">Simple.css</a>.<br> Content is available under <a target="_blank" rel="noopener" href="https://creativecommons.org/licenses/by-sa/4.0/">CC BY-SA 4.0 </a> unless noted otherwise.</p>
        <p>
            <a href="/atom.xml">
                <svg class="icon" aria-hidden="true" width="16" height="16" viewbox="0 -1 16 16" xmlns="http://www.w3.org/2000/svg">
                    <path fill="currentColor" d="M4.259 23.467c-2.35 0-4.259 1.917-4.259 4.252 0 2.349 1.909 4.244 4.259 4.244 2.358 0 4.265-1.895 4.265-4.244-0-2.336-1.907-4.252-4.265-4.252zM0.005 10.873v6.133c3.993 0 7.749 1.562 10.577 4.391 2.825 2.822 4.384 6.595 4.384 10.603h6.16c-0-11.651-9.478-21.127-21.121-21.127zM0.012 0v6.136c14.243 0 25.836 11.604 25.836 25.864h6.152c0-17.64-14.352-32-31.988-32z" transform="scale(0.46)" /></svg>RSS Feed</a> â€¢ <a target="_blank" rel="noopener" href="https://github.com/madnight/blog"><svg class="icon" aria-hidden="true" width="16" height="16" viewbox="0 0 16 16" xmlns="http://www.w3.org/2000/svg">
                    <path d="M8 0C3.58 0 0 3.58 0 8C0 11.54 2.29 14.53 5.47 15.59C5.87 15.66 6.02 15.42 6.02 15.21C6.02 15.02 6.01 14.39 6.01 13.72C4 14.09 3.48 13.23 3.32 12.78C3.23 12.55 2.84 11.84 2.5 11.65C2.22 11.5 1.82 11.13 2.49 11.12C3.12 11.11 3.57 11.7 3.72 11.94C4.44 13.15 5.59 12.81 6.05 12.6C6.12 12.08 6.33 11.73 6.56 11.53C4.78 11.33 2.92 10.64 2.92 7.58C2.92 6.71 3.23 5.99 3.74 5.43C3.66 5.23 3.38 4.41 3.82 3.31C3.82 3.31 4.49 3.1 6.02 4.13C6.66 3.95 7.34 3.86 8.02 3.86C8.7 3.86 9.38 3.95 10.02 4.13C11.55 3.09 12.22 3.31 12.22 3.31C12.66 4.41 12.38 5.23 12.3 5.43C12.81 5.99 13.12 6.7 13.12 7.58C13.12 10.65 11.25 11.33 9.47 11.53C9.76 11.78 10.01 12.26 10.01 13.01C10.01 14.08 10 14.94 10 15.21C10 15.42 10.15 15.67 10.55 15.59C13.71 14.53 16 11.53 16 8C16 3.58 12.42 0 8 0Z" fill="currentColor" />
                </svg>Source</a>
        </p>
    </footer>
</body>

</html>
